@using prototype.Models.Registrar
@{
    ViewBag.Title = "- Registrar";
    Layout = "~/Views/Shared/_AccountLayout.cshtml";
}

<div class="container" id="main-container">
    <div class="d-flex gap-5">
        <div class="input-group border border-black p-3 rounded-4">
            <i class="fa-solid fa-magnifying-glass mt-3 ms-3 me-3" style="font-size: 25px; color: grey;"></i><input type="search" name="" placeholder="241CS-IT30001" class="form-control">
            <button id="submit" type="submit" style="background-color: var(--main-color);" class="text-white rounded-end-4 p-3">Search</button>
        </div>
        <div class="d-flex text-white rounded-4 p-3 align-items-center" style="width: 50%;background-color: var(--main-color);">
            <p class="fw-bold fs-3 m-0">2:30<span class="fw-normal" style="vertical-align: super; font-size: 13px;">45</span>PM</p>
            <div>
                <p class="m-0 ms-3">Work Time</p>
                <p style="font-size: 10px;" class="m-0 ms-3">
                    Saturday, March 2, 2024 (GMT+8) <br>
                    Time in Manila, Metro Manila
                </p>
            </div>
        </div>
    </div>
    <div id="content-form" class="p-5 mt-3">
        @await Html.PartialAsync("_LogoutModal")
        <div class="d-flex gap-5">
            <div class="first-half" style="width: 70%;">
                <div>
                    <div style="background-color: var(--main-color);" class="me-4 rounded-4 text-white d-inline-block">
                        <div class="d-flex p-2 align-items-center gap-3">
                            <span class="fs-9 fw-bold">563</span>
                            <div><span>Pending <br>Students</span></div>
                        </div>
                    </div>
                    <div style="background-color: var(--secondary-color);" class="rounded-4 text-white d-inline-block">
                        <div class="d-flex p-2 align-items-center gap-3">
                            <span class="fs-9 fw-bold">43</span>
                            <div><span>Total <br>Students</span></div>
                        </div>
                    </div>
                    <div style="background-color: var(--secondary-color);" class="rounded-4 text-white d-inline-block">
                        <div class="d-flex p-2 align-items-center gap-3">
                            <span class="fs-9 fw-bold">5</span>
                            <div><span>Available <br>Room</span></div>
                        </div>
                    </div>
                    <!-- Action Icons (Add, Update, Delete Courses) -->
                    <div class="d-flex flex-column align-items-center">
                        <a href="@Url.Action("Section")" class="text-black"><i class="fa-solid fa-plus border border-black p-2 rounded-3 mainColorHover" style="width: 32px; cursor: pointer;"></i></a>
                        <span style="font-size: 12px;">SECTION DETAILS</span>
                    </div>

                    <div class="container mt-5">
                        <div class="row">
                            <!-- First column -->
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="academicBuilding" class="form-label">ACADEMIC BUILDING</label>
                                    <input type="text" id="academicBuilding" class="form-control" value="1,000 STUDENTS" readonly>
                                </div>
                                <div class="mb-3">
                                    <label for="bautistaBuilding" class="form-label">BAUTISTA BUILDING</label>
                                    <input type="text" id="bautistaBuilding" class="form-control" value="50 STUDENTS" readonly>
                                </div>
                                <div class="mb-3">
                                    <label for="openGround" class="form-label">OPEN GROUND</label>
                                    <input type="text" id="openGround" class="form-control" value="8,000 STUDENTS" readonly>
                                </div>
                            </div>
                            <!-- Second column -->
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="belmonteHall" class="form-label">BELMONTE HALL</label>
                                    <input type="text" id="belmonteHall" class="form-control" value="3,000 STUDENTS" readonly>
                                </div>
                                <div class="mb-3">
                                    <label for="yellowBuilding" class="form-label">YELLOW BUILDING</label>
                                    <input type="text" id="yellowBuilding" class="form-control" value="100 STUDENTS" readonly>
                                </div>
                                <div class="mb-3">
                                    <label for="korphil" class="form-label">KORPHIL</label>
                                    <input type="text" id="korphil" class="form-control" value="3,000 STUDENTS" readonly>
                                </div>
                            </div>
                        </div>
                    </div>
                    <br />
                    <br />
                    <br />
                    <br />
                    <br />

                    <p class="text-end"><a href="@Url.Action("Index")" class="text-decoration-none text-white p-2 rounded-3 black-on-hover" style="background-color: var(--main-color);">Back ></a></p>
                </div>
            </div>
            <!-- Section for Building and Room Information -->
            <div class="second-half" style="width: 50%;">
                <div class="border border-black rounded-3 p-3">
                    <div class="border border-black">
                        <div class="d-flex justify-content-between align-items-center text-white p-3" style="background-color: var(--main-color);">
                            <p class="fs-4 fw-bold m-0">Building Details</p>
                        </div>

                        <div class="container mt-5">
                            <div class="row mb-3 align-items-center">
                          
                        
                                <div class="col-md-4">
                                    <label for="buildingName" class="form-label">BUILDING NAME</label>
                                </div>
                                <div class="col-md-8">
                                    <select id="buildingName" class="form-select w-100">
                                        <option value="" selected>Select Building</option>
                                        @foreach (var building in ViewBag.Buildings)
                                        {
                                            <option value="@building.Building_Code" data-name="@building.Building_Name" data-code="@building.Building_Code">
                                                @building.Building_Name
                                            </option>
                                        }
                                    </select>
                                </div>
                            </div>

                            <div class="row mb-3 align-items-center">
                                <div class="col-md-4">
                                    <label for="buildingCodes" class="form-label">BUILDING CODE</label>
                                </div>
                                <div class="col-md-8">
                                    <input type="text" id="buildingCodes" class="form-control" readonly>
                                </div>
                            </div>

                            <div class="row mb-3 align-items-center">
                                <div class="col-md-4">
                                    <label for="Room_No" class="form-label">ROOM NO.</label>
                                </div>
                                <div class="col-md-8">
                                    <select id="Room_No" name="Room_No" class="form-select w-100">
                                        <option selected>Select Room</option>
                                    </select>
                                </div>
                            </div>

                            <div class="row mb-3 align-items-center">
                                <div class="col-md-4">
                                    <label for="roomAvailableSlot" class="form-label">ROOM AVAILABLE SLOT</label>
                                </div>
                                <div class="col-md-8">
                                    <input type="number" id="roomAvailableSlot" class="form-control" readonly>
                                </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
        @section Scripts {
            <script>
                // Serializing the entire building data to JavaScript
                var buildings = @Html.Raw(Json.Serialize(ViewBag.Buildings));

                // Listen for changes in the Building Name dropdown
                document.getElementById('buildingName').addEventListener('change', function () {
                    var selectedBuildingCode = this.value; // Get selected building code
                    var buildingCodeField = document.getElementById('buildingCodes');
                    var roomSelect = document.getElementById('Room_No');
                    var availableSlotField = document.getElementById('roomAvailableSlot');

                    // Set the Building Code field value
                    var selectedBuilding = buildings.find(function (building) {
                        return building.Building_Code === selectedBuildingCode;
                    });

                    if (selectedBuilding) {
                        buildingCodeField.value = selectedBuilding.Building_Code;

                        // Clear previous room options
                        roomSelect.innerHTML = '<option selected>Select Room</option>';

                        // Add new room options and available slots
                        selectedBuilding.Rooms.forEach(function (room) {
                            var option = document.createElement('option');
                            option.value = room.Room_No;
                            option.text = room.Room_No;
                            roomSelect.appendChild(option);
                        });

                        // Listen for changes in the Room No dropdown
                        roomSelect.addEventListener('change', function () {
                            var selectedRoom = selectedBuilding.Rooms.find(function (room) {
                                return room.Room_No === roomSelect.value;
                            });

                            if (selectedRoom) {
                                availableSlotField.value = selectedRoom.Room_Available_Slot;
                            }
                        });
                    }
                });
            </script>
        }
